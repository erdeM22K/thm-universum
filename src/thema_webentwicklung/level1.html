<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles_webentwicklung.css">
    <title>Webentwicklung Level 1: HTML</title>
</head>
<body>
    <div class="black_transparent">
        <a href="../thema_webentwicklung/wpr.html" class="back-to-home" title="Zurück zur Startseite">
            &#8592;
        </a>
        <div class="rocket_container">
            <ul id="columns">
                <li draggable="true" id="rocket_head" data-original-index="0" class="list-element"><span>&lt;div class="rocket_head"&gt;&lt;/div&gt;</span></li>
                <li draggable="true" id="rocket_body" data-original-index="1" class="list-element"><span>&lt;div class="rocket_body"&gt;&lt;/div&gt;</span></li>
                <li draggable="true" id="rocket_wings" data-original-index="2" class="list-element"><span>&lt;div class="rocket_wings"&gt;&lt;/div&gt;</span></li>
                <li draggable="true" id="rocket_engine" data-original-index="3" class="list-element"><span>&lt;div class="rocket_engine"&gt;&lt;/div&gt;</span></li>
              </ul>
            <img id="rocket" src="../bilder/webentwicklung/rocket.svg" alt="rocket">
        </div>
        <button class="button" onclick="checkOrder()">Check Order</button>
        <div class="copilot_container">
            <img class="copilot" src="../bilder/webentwicklung/copilot_sad.svg" alt="copilot_sad">
        </div>
        <div class="textfeld">
            <div id="text"></div>
            <div id="dots"></div>
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.1/TextPlugin.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.1/TweenMax.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/Draggable.min.js"></script> 
    <script src="script_level1.js"></script>

    <script>
        var text1 = "Hallo ich bin Copilot, Willkommen auf dem Level!";
        var text2 = "Dies ist eine Grundstruktur.";
        var text3 = "Und dies ist ein Beispiel Text.";
        const textAnimation = gsap.timeline();

        gsap.registerPlugin(TextPlugin, Draggable, TweenMax);

        document.addEventListener('DOMContentLoaded', (event) => {
            localStorage.setItem("lastLevel", "wpr1");
            startLevel();
            shuffleList();
            enableDragAndDrop();
        });

        textAnimation.to("#text", {
            duration: 3,
            text: text1,
            delay: 2,
            onComplete: function() {
                startDotsAnimation();
                console.log("Text 1 ausgeführt");
            }
        });

        document.querySelectorAll('.textfeld').forEach(function(element) {
            element.addEventListener('click', function() {
                const textElement = document.getElementById("text");
                if (textAnimation.isActive() && textAnimation.progress() < 1) {
                    textAnimation.progress(1);
                }
                else {
                    if (textElement.innerText === text1) {
                        clearText();
                        showNextText(text2);
                    } else if (textElement.innerText === text2) {
                        clearText();
                        showNextText(text3);
                        killDotsAnimation();
                        showButton();
                        showElements();
                    }
                }
            });
        });

        function startLevel() {
            gsap.to(".black_transparent", {
                duration: 3, 
                backgroundColor: "rgba(0, 0, 0, 0.5)", 
                ease: "power1.inOut"
            });
            gsap.from(".content", {
                x: 1500,
                duration: 3,
                stagger: 1,
                delay: 4,
                ease: 'power4.out',
            });
            gsap.from(".textfeld", {
                y: 1500,
                duration: 3,
                stagger: 1,
                ease: 'power4.out',
            });
            gsap.from(".rocket_container", {
                y: -1500,
                duration: 10,
                stagger: 3,
                ease: 'power4.out',
            });
            gsap.from(".copilot_container", {
                x: 1500,
                duration: 3,
                stagger: 2,
                ease: 'power4.out',
            });
        }

        function showNextText(text) {
            textAnimation.to("#text", {
                duration: 3,
                delay: 1,
                text: text,
                onComplete: function() {
                    startDotsAnimation();
                    console.log("Text wird ausgeführt");
                }
            });
        }

        function clearText() {
            textAnimation.to("#text", {
                duration: 0.5,
                text: "",
                onComplete: function() {
                    console.log("Textfeld geleert");
                }
            });
            document.getElementById("dots").style.display = "none";
        }

        function startDotsAnimation() {
            if (document.getElementById("text").innerText === text3) {
                document.getElementById("dots").style.display = "none";
            } else {
                document.getElementById("dots").style.display = "block";
                gsap.to("#dots", { duration: 1, repeat: -1, yoyo: true, ease: "power1.inOut", x: "+=10" });
                gsap.to("#dots", {
                    duration: 2,
                    repeat: -1,
                    text: "...>",
                    onComplete: function() {
                        console.log("Textfeld geleert");
                    }
                });
            }
        }

        function killDotsAnimation() {
            document.getElementById("dots").style.display = "none";
        }
    </script>
</body>
</html>
